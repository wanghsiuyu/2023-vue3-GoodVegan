import{_ as N,m as V,b as k,r as _,o as i,c,e as n,d as e,w as b,F as v,y as T,t as m,h as r,f as U,G as L,D as A,E,H as p,z as I,A as R}from"./index-a41db151.js";import{l as S}from"./loadingStore-deeb7e0b.js";import{c as C}from"./cartsStore-464dc09b.js";const{VITE_URL:D,VITE_PATH:q}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"gracewang",BASE_URL:"/vue3-QA/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},P={data(){return{user:{name:"",email:"",tel:"",address:""},message:""}},methods:{onSubmit(){if(this.cartsTotal.carts.length){this.loading();const s={user:this.user,message:this.message};this.$http.post(`${D}/api/${q}/order`,{data:s}).then(a=>{alert(a.data.message),this.loading(),this.getCart(),this.$refs.form.resetForm()}).catch(a=>{alert(a.response.data.message)})}else alert("目前購物車沒有任何品項，無法送出訂單。")},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需為正確的手機號碼格式"},...V(S,["loading"]),...V(C,["addToCart","getCart","removeCart","removeCartsAll","setCartQty"])},computed:{...k(C,["cartsTotal","cartsTotalNum","shipping"]),...k(S,["isLoading","loadingStatus"])},mounted(){this.getCart(),this.loading()}},l=s=>(I("data-v-ed20170a"),s=s(),R(),s),$=U('<section class="mb-5 banner" style="height:380px;" data-v-ed20170a><div class="container" data-v-ed20170a><div class="row justify-content-center" data-v-ed20170a><div class="col-sm-9 col-md-7 col-lg-5" data-v-ed20170a><h1 class="banner-plan fs-3 fs-lg-2" data-v-ed20170a>訂單確認</h1></div></div></div></section>',1),B={class:"container"},O={"aria-label":"breadcrumb"},z={class:"breadcrumb mb-5"},F={class:"breadcrumb-item"},H={class:"breadcrumb-item"},M=l(()=>e("li",{class:"breadcrumb-item active","aria-current":"page"},"訂單確認",-1)),Q={class:"row justify-content-center mb-20 mb-lg-8"},j={class:"col-8"},G={class:"mb-5"},J=l(()=>e("h2",{class:"h3 text-center"},"購物車",-1)),K={key:0,class:"text-center"},W={key:1},X={class:"text-end my-4"},Y={class:"table align-middle"},Z=l(()=>e("tr",{class:"border-bottom"},[e("td"),e("td",null,"品項"),e("td"),e("td",null,"單價"),e("td",null,"數量"),e("td",{class:"text-center"},"價格")],-1)),ee=["onClick","disabled"],se={key:0,class:"fas fa-spinner fa-pulse"},te={key:1,class:"material-icons fs-6 text-dark"},ae=["src"],oe={class:"text-start"},le={class:"text-start"},ne=["onUpdate:modelValue","onChange","disabled"],de=["value"],ie={class:"text-end"},ce=l(()=>e("td",{colspan:"4"},"小計",-1)),re={colspan:"2",class:"text-end"},me={class:"border-bottom"},ue={colspan:"4"},_e={key:0,class:"text-danger"},he={key:1,class:"text-danger"},pe={colspan:"2",class:"text-end"},be=l(()=>e("td",{colspan:"4",class:"fs-5"},"總計",-1)),ve={colspan:"2",class:"fs-5 text-end"},ge={class:"col-6"},fe={class:"mb-5"},ye=l(()=>e("h2",{class:"h3 text-center"},"訂單連絡資訊",-1)),Ve={class:"mb-4"},ke=l(()=>e("label",{for:"name",class:"form-label"},[r("姓名"),e("span",{class:"text-danger"},"*")],-1)),Te={class:"mb-4"},Se=l(()=>e("label",{for:"phone",class:"form-label"},[r("手機"),e("span",{class:"text-danger"},"*")],-1)),Ce={class:"mb-3"},xe=l(()=>e("label",{for:"email",class:"form-label"},[r("信箱"),e("span",{class:"text-danger"},"*")],-1)),we=l(()=>e("div",{class:"form-check mb-4"},[e("input",{class:"form-check-input",type:"checkbox",value:"",id:"subscribe",checked:""}),e("label",{class:"form-check-label",for:"subscribe"},"願意收到好蔬房的相關訊息和優惠資訊")],-1)),Ne={class:"mb-4"},Ue=l(()=>e("label",{for:"address",class:"form-label"},[r("外送地址"),e("span",{class:"text-danger"},"*"),r("（到店自取者請填寫「自取」）")],-1)),Le={class:"mb-4"},Ae=l(()=>e("label",{for:"message",class:"form-label"},"訂單備註",-1)),Ee=l(()=>e("div",{class:"mb-4"},[e("p",null,[r("註："),e("span",{class:"text-danger"},"*"),r("為必填欄位")])],-1)),Ie=l(()=>e("div",{class:"text-center"},[e("button",{type:"submit",class:"btn btn-secondary btn-lg"},"送出訂單")],-1));function Re(s,a,De,qe,d,g){var y;const x=_("VueLoading"),f=_("RouterLink"),u=_("v-field"),h=_("error-message"),w=_("v-form");return i(),c(v,null,[n(x,{active:s.isLoading,"onUpdate:active":a[0]||(a[0]=t=>s.isLoading=t)},null,8,["active"]),$,e("section",B,[e("nav",O,[e("ol",z,[e("li",F,[n(f,{to:"/",class:"green"},{default:b(()=>[r("首頁")]),_:1})]),e("li",H,[n(f,{to:"/products",class:"green"},{default:b(()=>[r("線上訂餐")]),_:1})]),M])]),e("div",Q,[e("div",j,[e("div",G,[J,(y=s.cartsTotal.carts)!=null&&y.length?(i(),c("div",W,[e("div",X,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:a[1]||(a[1]=(...t)=>s.removeCartsAll&&s.removeCartsAll(...t))},"清空購物車")]),e("table",Y,[e("tbody",null,[Z,(i(!0),c(v,null,T(s.cartsTotal.carts,t=>(i(),c("tr",{key:t.id},[e("td",null,[e("a",{role:"button",class:"text-end",title:"刪除品項",onClick:L(o=>s.removeCart(t.id),["prevent"]),disabled:s.loadingStatus===t.id},[s.loadingStatus===t.id?(i(),c("i",se)):(i(),c("span",te," close "))],8,ee)]),e("td",null,[e("img",{src:t.product.imageUrl,class:"img-cover",width:"90",height:"90",alt:"cart.product.title"},null,8,ae)]),e("td",oe,m(t.product.title),1),e("td",le,"NT$"+m(t.product.price)+" / "+m(t.product.unit),1),e("td",null,[A(e("select",{"onUpdate:modelValue":o=>t.qty=o,class:"form-select",onChange:o=>s.setCartQty(t),disabled:s.loadingStatus===t.id},[(i(),c(v,null,T(20,o=>e("option",{key:o+1234,value:o},m(o),9,de)),64))],40,ne),[[E,t.qty]])]),e("td",ie,"NT$"+m(t.total),1)]))),128)),e("tr",null,[ce,e("td",re,"NT$"+m(s.cartsTotal.total),1)]),e("tr",me,[e("td",ue,[r(" 運費 "),s.cartsTotal.total<500?(i(),c("span",_e,"（消費滿 $500，即可享免運優惠！）")):(i(),c("span",he,"（恭禧您已達免運門檻！）"))]),e("td",pe,"NT$"+m(s.shipping),1)]),e("tr",null,[be,e("td",ve,"NT$"+m(s.cartsTotal.final_total+s.shipping),1)])])])])):(i(),c("h4",K,"購物車沒有任何品項"))])]),e("div",ge,[e("div",fe,[n(w,{onSubmit:g.onSubmit,ref:"form"},{default:b(({errors:t})=>[ye,e("div",Ve,[ke,n(u,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":t.姓名}]),placeholder:"王小明",rules:"required",modelValue:d.user.name,"onUpdate:modelValue":a[2]||(a[2]=o=>d.user.name=o)},null,8,["class","modelValue"]),n(h,{name:"姓名",class:"invalid-feedback"})]),e("div",Te,[Se,n(u,{id:"phone",name:"電話",type:"tel",class:p(["form-control",{"is-invalid":t.電話}]),placeholder:"0912345678",rules:g.isPhone,modelValue:d.user.tel,"onUpdate:modelValue":a[3]||(a[3]=o=>d.user.tel=o)},null,8,["class","rules","modelValue"]),n(h,{name:"電話",class:"invalid-feedback"})]),e("div",Ce,[xe,n(u,{id:"email",name:"email",type:"email",class:p(["form-control",{"is-invalid":t.email}]),placeholder:"name@email.com",rules:"email|required",modelValue:d.user.email,"onUpdate:modelValue":a[4]||(a[4]=o=>d.user.email=o)},null,8,["class","modelValue"]),n(h,{name:"email",class:"invalid-feedback"})]),we,e("div",Ne,[Ue,n(u,{id:"address",name:"外送地址",type:"text",class:p(["form-control",{"is-invalid":t.外送地址}]),placeholder:"自取／○○區○街○巷○號",rules:"required",modelValue:d.user.address,"onUpdate:modelValue":a[5]||(a[5]=o=>d.user.address=o)},null,8,["class","modelValue"]),n(h,{name:"外送地址",class:"invalid-feedback"})]),e("div",Le,[Ae,n(u,{as:"textarea",id:"message",name:"訂單備註",class:"form-control",rows:"5",modelValue:d.message,"onUpdate:modelValue":a[6]||(a[6]=o=>d.message=o),style:{resize:"none"}},null,8,["modelValue"])]),Ee,Ie]),_:1},8,["onSubmit"])])])])])],64)}const Oe=N(P,[["render",Re],["__scopeId","data-v-ed20170a"]]);export{Oe as default};
