import{_ as T,m as g,b as v,r as _,o as i,c as n,e as a,d as e,F as b,y,t as c,h as r,w as C,f as S,G as u,H as N,D as U,E as A}from"./index-0aeb2573.js";import{l as x}from"./loadingStore-52d29748.js";import{c as w}from"./cartsStore-36185f5b.js";const j="/vue3-QA/assets/delete-dfa5e92e.svg",E="/vue3-QA/assets/empty-cart-20fd15ad.svg",{VITE_URL:I,VITE_PATH:L}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"gracewang",BASE_URL:"/vue3-QA/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},$={data(){return{user:{name:"",email:"",tel:"",address:""},message:"",orderId:""}},methods:{onSubmit(){if(this.cartsTotal.carts.length){this.loading();const t={user:this.user,message:this.message};this.$http.post(`${I}/api/${L}/order`,{data:t}).then(o=>{alert(o.data.message),this.loading(),this.getCart(),this.$refs.form.resetForm(),this.orderId=o.data.orderId,this.$router.push(`/order/checkout/${this.orderId}`)}).catch(o=>{alert(o.response.data.message)})}else alert("目前購物車沒有任何品項，無法送出訂單。")},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"需為正確的手機號碼格式"},...g(x,["loading"]),...g(w,["addToCart","getCart","removeCart","removeCartsAll","setCartQty"])},computed:{...v(w,["cartsTotal","cartsTotalNum","shipping"]),...v(x,["isLoading","loadingStatus"])},mounted(){this.getCart(),this.loading()}},D={key:0},q=S('<div class="row justify-content-center mb-10"><div class="col-3 border-bottom border-5 border-primary"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;">1</div><p class="text-primary mb-2 fw-bold">填寫資料</p></div></div><div class="col-3 border-bottom border-5 border-gray"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-gray text-white d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;">2</div><p class="text-gray mb-2 fw-bold">確認付款</p></div></div><div class="col-3 border-bottom border-5 border-gray"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-gray text-white d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;">3</div><p class="text-gray mb-2 fw-bold">付款成功</p></div></div></div>',1),P={class:"row"},Q={class:"col-lg-6 mb-5 mb-lg-0"},R=e("a",{href:"#/products"},[e("p",{class:"d-flex align-items-center text-dark mb-6"},[e("span",{class:"material-icons fs-6 me-2"}," arrow_back_ios_new "),r("繼續購物")])],-1),B={class:"table align-middle"},F=e("tr",{class:"border-bottom"},null,-1),H={class:"d-flex align-items-center justify-content-between gap-5 gap-md-10 py-4"},M=["onClick"],O={key:0,class:"fas fa-spinner fa-pulse"},z={key:1,src:j,alt:"delete"},G=["src"],J={class:"d-flex flex-column flex-md-row align-items-md-center w-75"},K={class:"d-flex flex-column w-md-75"},W={class:"mb-1 mb-md-0"},X={class:"mb-1 mb-md-0"},Y={class:"mb-2 mb-md-0 w-md-50"},Z=["onUpdate:modelValue","onChange","disabled"],ee=["value"],se={class:"mb-0 fs-6 text-primary text-md-end w-md-25"},te={class:"row px-2"},oe={class:"col-md-4"},le={class:"col-md-8"},ae={class:"d-flex justify-content-between"},de=e("p",{class:"fs-6 mb-2"},"小計",-1),ie={class:"fs-6 mb-2 fw-bold"},ne={class:"col-md-8 offset-md-4"},re={class:"d-flex justify-content-between"},ce={class:"fs-6 mb-2"},me={key:0,class:"text-danger"},ue={key:1,class:"text-danger"},pe={class:"fs-6 mb-2 fw-bold"},_e={class:"d-flex justify-content-between"},be=e("p",{class:"fs-6 mb-2"},"總計",-1),he={class:"fs-6 mb-2 fw-bold"},fe={class:"col-lg-6"},ge={class:"card border-0 bg-primary-light py-4 p-lg-5"},ve={class:"card-body"},ye=e("h2",{class:"h5 text-center mb-6"},"訂單連絡資訊",-1),xe={class:"mb-4"},we=e("label",{for:"name",class:"form-label"},[r("姓名"),e("span",{class:"text-danger"},"*")],-1),Ve={class:"mb-4"},ke=e("label",{for:"phone",class:"form-label"},[r("手機"),e("span",{class:"text-danger"},"*")],-1),Te={class:"mb-3"},Ce=e("label",{for:"email",class:"form-label"},[r("信箱"),e("span",{class:"text-danger"},"*")],-1),Se=e("div",{class:"form-check mb-4"},[e("input",{class:"form-check-input",type:"checkbox",value:"",id:"subscribe",checked:""}),e("label",{class:"form-check-label",for:"subscribe"},"願意收到好蔬房的相關訊息和優惠資訊")],-1),Ne={class:"mb-4"},Ue=e("label",{for:"address",class:"form-label"},[r("外送地址"),e("span",{class:"text-danger"},"*"),r("（到店自取者請填寫「自取」）")],-1),Ae={class:"mb-4"},je=e("label",{for:"message",class:"form-label"},"訂單備註",-1),Ee=e("div",{class:"mb-4"},[e("p",null,[r("註："),e("span",{class:"text-danger"},"*"),r("為必填欄位")])],-1),Ie=e("button",{type:"submit",class:"btn btn-primary w-100"},"送出訂單",-1),Le={key:1,class:"text-center"},$e=e("img",{src:E,alt:"empty-cart",class:"mb-6"},null,-1),De=e("h3",{class:"mb-6"},"您的購物車目前是空的喔",-1),qe=e("a",{href:"#/products",class:"btn btn-primary fs-lg-5 px-5 py-3 px-lg-6"},"現在就去逛逛",-1),Pe=[$e,De,qe];function Qe(t,o,Re,Be,d,h){var f;const V=_("VueLoading"),m=_("v-field"),p=_("error-message"),k=_("v-form");return i(),n(b,null,[a(V,{active:t.isLoading,"onUpdate:active":o[0]||(o[0]=s=>t.isLoading=s)},null,8,["active"]),(f=t.cartsTotal.carts)!=null&&f.length?(i(),n("div",D,[q,e("div",P,[e("section",Q,[R,e("table",B,[e("tbody",null,[F,(i(!0),n(b,null,y(t.cartsTotal.carts,s=>(i(),n("tr",{key:s.id},[e("td",H,[e("div",null,[e("a",{role:"button",class:u(["btn p-0",{disabled:t.loadingStatus===s.id}]),title:"刪除品項",onClick:N(l=>t.removeCart(s.id),["prevent"]),style:{"border-color":"transparent"}},[t.loadingStatus===s.id?(i(),n("i",O)):(i(),n("img",z))],10,M)]),e("img",{src:s.product.imageUrl,class:"object-fit-cover d-block",width:"90",height:"90",alt:"cart.product.title"},null,8,G),e("div",J,[e("div",K,[e("p",W,c(s.product.title),1),e("p",X,"NT$"+c(s.product.price)+" / "+c(s.product.unit),1),e("div",Y,[U(e("select",{"onUpdate:modelValue":l=>s.qty=l,class:"form-select form-select-sm",onChange:l=>t.setCartQty(s),disabled:t.loadingStatus===s.id},[(i(),n(b,null,y(20,l=>e("option",{key:l+1234,value:l},c(l),9,ee)),64))],40,Z),[[A,s.qty]])])]),e("p",se,"NT$"+c(s.total),1)])])]))),128))])]),e("div",te,[e("div",oe,[e("button",{type:"button",class:"btn btn-outline-primary mb-8 mb-md-0",onClick:o[1]||(o[1]=(...s)=>t.removeCartsAll&&t.removeCartsAll(...s))},"清空購物車")]),e("div",le,[e("div",ae,[de,e("p",ie,"NT$"+c(t.cartsTotal.total),1)])]),e("div",ne,[e("div",re,[e("p",ce,[r(" 運費 "),t.cartsTotal.total<500?(i(),n("small",me,"(消費滿 $500 可享免運優惠)")):(i(),n("small",ue,"(恭禧您已達免運門檻！)"))]),e("p",pe,"NT$"+c(t.shipping),1)]),e("div",_e,[be,e("p",he,"NT$"+c(t.cartsTotal.final_total+t.shipping),1)])])])]),e("section",fe,[e("div",ge,[e("div",ve,[a(k,{onSubmit:h.onSubmit,ref:"form"},{default:C(({errors:s})=>[ye,e("div",xe,[we,a(m,{id:"name",name:"姓名",type:"text",class:u(["form-control",{"is-invalid":s.姓名}]),placeholder:"王小明",rules:"required",modelValue:d.user.name,"onUpdate:modelValue":o[2]||(o[2]=l=>d.user.name=l)},null,8,["class","modelValue"]),a(p,{name:"姓名",class:"invalid-feedback"})]),e("div",Ve,[ke,a(m,{id:"phone",name:"電話",type:"tel",class:u(["form-control",{"is-invalid":s.電話}]),placeholder:"0912345678",rules:h.isPhone,modelValue:d.user.tel,"onUpdate:modelValue":o[3]||(o[3]=l=>d.user.tel=l)},null,8,["class","rules","modelValue"]),a(p,{name:"電話",class:"invalid-feedback"})]),e("div",Te,[Ce,a(m,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":s.email}]),placeholder:"name@email.com",rules:"email|required",modelValue:d.user.email,"onUpdate:modelValue":o[4]||(o[4]=l=>d.user.email=l)},null,8,["class","modelValue"]),a(p,{name:"email",class:"invalid-feedback"})]),Se,e("div",Ne,[Ue,a(m,{id:"address",name:"外送地址",type:"text",class:u(["form-control",{"is-invalid":s.外送地址}]),placeholder:"自取／○○區○街○巷○號",rules:"required",modelValue:d.user.address,"onUpdate:modelValue":o[5]||(o[5]=l=>d.user.address=l)},null,8,["class","modelValue"]),a(p,{name:"外送地址",class:"invalid-feedback"})]),e("div",Ae,[je,a(m,{as:"textarea",id:"message",name:"訂單備註",class:"form-control",rows:"5",modelValue:d.message,"onUpdate:modelValue":o[6]||(o[6]=l=>d.message=l),style:{resize:"none"}},null,8,["modelValue"])]),Ee,Ie]),_:1},8,["onSubmit"])])])])])])):(i(),n("div",Le,Pe))],64)}const Oe=T($,[["render",Qe]]);export{Oe as default};
