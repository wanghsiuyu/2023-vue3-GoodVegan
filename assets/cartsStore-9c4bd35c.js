import{H as l,I as o}from"./index-ef04eae2.js";import{l as d}from"./loadingStore-991ac614.js";import{T as a,S as h}from"./toast-1bc0252f.js";const i=d(),{VITE_URL:r,VITE_PATH:n}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"gracewang",BASE_URL:"/2023-vue3-GoodVegan/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},p=l("cartsStore",{state:()=>({cartsTotal:{},cartsTotalNum:0,shipping:0}),actions:{addToCart(t,e=1){const s={product_id:t,qty:e};i.loadingStatus=t,o.post(`${r}/api/${n}/cart`,{data:s}).then(c=>{i.loadingStatus="",a.fire({icon:"success",title:c.data.message,width:250}),this.getCart()}).catch(c=>{a.fire({icon:"error",title:c.response.data.message,width:250})})},getCart(){o.get(`${r}/api/${n}/cart`).then(t=>{this.cartsTotal=t.data.data,this.cartsTotalNum=this.cartsTotal.carts.reduce((e,s)=>e+s.qty,0),this.shipping=parseInt(this.cartsTotal.total>=500?0:100)}).catch(t=>{a.fire({icon:"error",title:t.response.data.message,width:250})})},removeCart(t){i.loadingStatus=t,o.delete(`${r}/api/${n}/cart/${t}`).then(e=>{i.loadingStatus="",a.fire({icon:"success",title:e.data.message,width:250}),this.getCart()}).catch(e=>{a.fire({icon:"error",title:e.response.data.message,width:250})})},confirmRemove(){const t=h.mixin({customClass:{confirmButton:"btn btn-danger ms-2",cancelButton:"btn btn-outline-danger"},buttonsStyling:!1});t.fire({title:"您是否要刪除購物車所有商品？",text:"刪除後將無法恢復",icon:"warning",showCancelButton:!0,confirmButtonText:"確認刪除",cancelButtonText:"取消",reverseButtons:!0}).then(e=>{e.isConfirmed&&(this.removeCartsAll(),t.fire("已刪除！","您的購物車已清空","success"))})},removeCartsAll(){o.delete(`${r}/api/${n}/carts`).then(()=>{this.getCart()}).catch(t=>{a.fire({icon:"error",title:t.response.data.message,width:250})})},setCartQty(t){const e={product_id:t.product_id,qty:t.qty};i.loadingStatus=t.id,o.put(`${r}/api/${n}/cart/${t.id}`,{data:e}).then(s=>{i.loadingStatus="",a.fire({icon:"success",title:s.data.message,width:250}),this.getCart()}).catch(s=>{a.fire({icon:"error",title:s.response.data.message,width:250})})}}});export{p as c};
