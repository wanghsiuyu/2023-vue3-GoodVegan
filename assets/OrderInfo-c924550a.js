import{_ as C,m as g,b as v,r as p,o as d,c as i,e as a,d as s,F as h,y,t as r,h as c,w as x,G as _,H as S,D as U,E as N}from"./index-81e4f8a2.js";import{l as V}from"./loadingStore-f8f0d968.js";import{c as k}from"./cartsStore-3ac09770.js";const A="/vue3-QA/assets/delete-dfa5e92e.svg",E="/vue3-QA/assets/empty-cart-a5bb2d86.svg",{VITE_URL:L,VITE_PATH:D}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"gracewang",BASE_URL:"/vue3-QA/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},j={data(){return{user:{name:"",email:"",tel:"",address:""},message:""}},methods:{onSubmit(){if(this.cartsTotal.carts.length){this.loading();const t={user:this.user,message:this.message};this.$http.post(`${L}/api/${D}/order`,{data:t}).then(o=>{alert(o.data.message),this.loading(),this.getCart(),this.$refs.form.resetForm()}).catch(o=>{alert(o.response.data.message)})}else alert("目前購物車沒有任何品項，無法送出訂單。")},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"需為正確的手機號碼格式"},...g(V,["loading"]),...g(k,["addToCart","getCart","removeCart","removeCartsAll","setCartQty"])},computed:{...v(k,["cartsTotal","cartsTotalNum","shipping"]),...v(V,["isLoading","loadingStatus"])},mounted(){this.getCart(),this.loading()}},q={class:"my-8 my-md-20"},I={key:0},P={class:"row"},Q={class:"col-lg-6 mb-5 mb-lg-0"},R=s("a",{href:"#/products"},[s("p",{class:"d-flex align-items-center text-dark mb-6"},[s("span",{class:"material-icons fs-6 me-2"}," arrow_back_ios_new "),c("繼續購物")])],-1),$={class:"table align-middle"},B=s("tr",{class:"border-bottom"},null,-1),F={class:"d-flex align-items-center justify-content-between gap-5 gap-md-10 py-4"},H=["onClick"],M={key:0,class:"fas fa-spinner fa-pulse"},O={key:1,src:A,alt:"delete"},z=["src"],G={class:"d-flex flex-column flex-md-row align-items-md-center w-75"},J={class:"d-flex flex-column w-md-75"},K={class:"mb-1 mb-md-0"},W={class:"mb-1 mb-md-0"},X={class:"mb-2 mb-md-0 w-md-50"},Y=["onUpdate:modelValue","onChange","disabled"],Z=["value"],ss={class:"mb-0 fs-5 text-primary text-md-end w-md-25"},es={class:"row"},ts={class:"col-md-4"},os={class:"col-md-8"},ls={class:"d-flex justify-content-between"},as=s("p",{class:"fs-5 mb-2"},"小計",-1),ns={class:"fs-4 mb-2 fw-bold"},ds={class:"col-md-8 offset-md-4"},is={class:"d-flex justify-content-between"},cs={class:"fs-5 mb-2"},rs={key:0,class:"text-danger"},ms={key:1,class:"text-danger"},_s={class:"fs-4 mb-2 fw-bold"},us={class:"col-md-8 offset-md-4"},ps={class:"d-flex justify-content-between"},hs=s("p",{class:"fs-5 mb-2"},"總計",-1),bs={class:"fs-4 mb-2 fw-bold"},fs={class:"col-lg-6"},gs={class:"card border-0 bg-primary-light py-4 p-lg-5"},vs={class:"card-body"},ys=s("h2",{class:"h5 text-center mb-6"},"訂單連絡資訊",-1),Vs={class:"mb-4"},ks=s("label",{for:"name",class:"form-label"},[c("姓名"),s("span",{class:"text-danger"},"*")],-1),ws={class:"mb-4"},Ts=s("label",{for:"phone",class:"form-label"},[c("手機"),s("span",{class:"text-danger"},"*")],-1),Cs={class:"mb-3"},xs=s("label",{for:"email",class:"form-label"},[c("信箱"),s("span",{class:"text-danger"},"*")],-1),Ss=s("div",{class:"form-check mb-4"},[s("input",{class:"form-check-input",type:"checkbox",value:"",id:"subscribe",checked:""}),s("label",{class:"form-check-label",for:"subscribe"},"願意收到好蔬房的相關訊息和優惠資訊")],-1),Us={class:"mb-4"},Ns=s("label",{for:"address",class:"form-label"},[c("外送地址"),s("span",{class:"text-danger"},"*"),c("（到店自取者請填寫「自取」）")],-1),As={class:"mb-4"},Es=s("label",{for:"message",class:"form-label"},"訂單備註",-1),Ls=s("div",{class:"mb-4"},[s("p",null,[c("註："),s("span",{class:"text-danger"},"*"),c("為必填欄位")])],-1),Ds=s("button",{type:"submit",class:"btn btn-primary w-100"},"送出訂單",-1),js={key:1,class:"text-center"},qs=s("img",{src:E,alt:"empty-cart",class:"mb-6"},null,-1),Is=s("h3",{class:"mb-6"},"您的購物車目前是空的喔",-1),Ps=s("a",{href:"#/products",class:"btn btn-primary fs-lg-5 px-5 py-3 px-lg-6"},"現在就去逛逛",-1),Qs=[qs,Is,Ps];function Rs(t,o,$s,Bs,n,b){var f;const w=p("VueLoading"),m=p("v-field"),u=p("error-message"),T=p("v-form");return d(),i(h,null,[a(w,{active:t.isLoading,"onUpdate:active":o[0]||(o[0]=e=>t.isLoading=e)},null,8,["active"]),s("div",q,[(f=t.cartsTotal.carts)!=null&&f.length?(d(),i("div",I,[s("div",P,[s("section",Q,[R,s("table",$,[s("tbody",null,[B,(d(!0),i(h,null,y(t.cartsTotal.carts,e=>(d(),i("tr",{key:e.id},[s("td",F,[s("div",null,[s("a",{role:"button",class:_(["btn p-0",{disabled:t.loadingStatus===e.id}]),title:"刪除品項",onClick:S(l=>t.removeCart(e.id),["prevent"]),style:{"border-color":"transparent"}},[t.loadingStatus===e.id?(d(),i("i",M)):(d(),i("img",O))],10,H)]),s("img",{src:e.product.imageUrl,class:"object-fit-cover d-block",width:"90",height:"90",alt:"cart.product.title"},null,8,z),s("div",G,[s("div",J,[s("p",K,r(e.product.title),1),s("p",W,"NT$"+r(e.product.price)+" / "+r(e.product.unit),1),s("div",X,[U(s("select",{"onUpdate:modelValue":l=>e.qty=l,class:"form-select form-select-sm",onChange:l=>t.setCartQty(e),disabled:t.loadingStatus===e.id},[(d(),i(h,null,y(20,l=>s("option",{key:l+1234,value:l},r(l),9,Z)),64))],40,Y),[[N,e.qty]])])]),s("p",ss,"NT$"+r(e.total),1)])])]))),128))])]),s("div",es,[s("div",ts,[s("button",{type:"button",class:"btn btn-outline-primary mb-8 mb-md-0",onClick:o[1]||(o[1]=(...e)=>t.removeCartsAll&&t.removeCartsAll(...e))},"清空購物車")]),s("div",os,[s("div",ls,[as,s("p",ns,"NT$"+r(t.cartsTotal.total),1)])]),s("div",ds,[s("div",is,[s("p",cs,[c(" 運費 "),t.cartsTotal.total<500?(d(),i("span",rs,"（消費滿 $500，即可享免運優惠！）")):(d(),i("small",ms,"(恭禧您已達免運門檻！)"))]),s("p",_s,"NT$"+r(t.shipping),1)])]),s("div",us,[s("div",ps,[hs,s("p",bs,"NT$"+r(t.cartsTotal.final_total+t.shipping),1)])])])]),s("section",fs,[s("div",gs,[s("div",vs,[a(T,{onSubmit:b.onSubmit,ref:"form"},{default:x(({errors:e})=>[ys,s("div",Vs,[ks,a(m,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":e.姓名}]),placeholder:"王小明",rules:"required",modelValue:n.user.name,"onUpdate:modelValue":o[2]||(o[2]=l=>n.user.name=l)},null,8,["class","modelValue"]),a(u,{name:"姓名",class:"invalid-feedback"})]),s("div",ws,[Ts,a(m,{id:"phone",name:"電話",type:"tel",class:_(["form-control",{"is-invalid":e.電話}]),placeholder:"0912345678",rules:b.isPhone,modelValue:n.user.tel,"onUpdate:modelValue":o[3]||(o[3]=l=>n.user.tel=l)},null,8,["class","rules","modelValue"]),a(u,{name:"電話",class:"invalid-feedback"})]),s("div",Cs,[xs,a(m,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":e.email}]),placeholder:"name@email.com",rules:"email|required",modelValue:n.user.email,"onUpdate:modelValue":o[4]||(o[4]=l=>n.user.email=l)},null,8,["class","modelValue"]),a(u,{name:"email",class:"invalid-feedback"})]),Ss,s("div",Us,[Ns,a(m,{id:"address",name:"外送地址",type:"text",class:_(["form-control",{"is-invalid":e.外送地址}]),placeholder:"自取／○○區○街○巷○號",rules:"required",modelValue:n.user.address,"onUpdate:modelValue":o[5]||(o[5]=l=>n.user.address=l)},null,8,["class","modelValue"]),a(u,{name:"外送地址",class:"invalid-feedback"})]),s("div",As,[Es,a(m,{as:"textarea",id:"message",name:"訂單備註",class:"form-control",rows:"5",modelValue:n.message,"onUpdate:modelValue":o[6]||(o[6]=l=>n.message=l),style:{resize:"none"}},null,8,["modelValue"])]),Ls,Ds]),_:1},8,["onSubmit"])])])])])])):(d(),i("div",js,Qs))])],64)}const Os=C(j,[["render",Rs]]);export{Os as default};
